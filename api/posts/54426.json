{"title":"AC-Docker","slug":"AC-Docker","date":"2023-05-28","updated":"2024-01-07","comments":true,"path":"api/posts/54426.json","excerpt":"<blockquote><p> 关于 Docker 的相关信息 </p></blockquote>","cover":null,"covers":null,"content":"<blockquote>\n<p>关于 Docker 的相关信息</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"容器基本命令\"><a href=\"# 容器基本命令\" class=\"headerlink\" title=\"容器基本命令\"></a>容器基本命令</h1><ul>\n<li>mysql<ul>\n<li>docker exec -it mysql bash 进入到容器中</li>\n<li>docker run -d –name=mysql_container -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root mysql8.0.25 启动 mysql</li>\n</ul>\n</li>\n</ul>\n<p>ALTER USER ‘root‘@’localhost’ IDENTIFIED WITH mysql_native_password BY ‘root’;</p>\n<p>ALTER USER <a href=\"mailto:&#114;&#x6f;&#111;&#x74;&#x40;&#49;&#57;&#x32;&#46;&#49;&#54;&#x38;&#46;&#52;&#x33;&#x2e;&#50;&#49;\">&#114;&#x6f;&#111;&#x74;&#x40;&#49;&#57;&#x32;&#46;&#49;&#54;&#x38;&#46;&#52;&#x33;&#x2e;&#50;&#49;</a> IDENTIFIED WITH mysql_native_password BY ‘root’;</p>\n<h2 id=\"实例命令\"><a href=\"# 实例命令\" class=\"headerlink\" title=\"实例命令\"></a>实例命令</h2><ul>\n<li>删除实例：docker rm containerID</li>\n<li>查看实例<ul>\n<li>docker ps 只有当前存活的实例</li>\n<li>docker ps -a 所有实例，包括没运行的</li>\n<li>不省略字段信息，全展示：docker ps -a –no-trunc</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"镜像命令\"><a href=\"# 镜像命令\" class=\"headerlink\" title=\"镜像命令\"></a>镜像命令</h2><ul>\n<li>删除镜像<ul>\n<li>docker rmi imageID</li>\n<li>docker rmi -f imageID 强制删除</li>\n</ul>\n</li>\n<li>查看镜像<ul>\n<li>docker images 查看所有镜像</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"部署 SpringBoot 项目\"><a href=\"# 部署 SpringBoot 项目\" class=\"headerlink\" title=\"部署 SpringBoot 项目\"></a>部署 SpringBoot 项目 </h2><h3 id=\"首次部署\"><a href=\"# 首次部署\" class=\"headerlink\" title=\"首次部署\"></a> 首次部署</h3><ul>\n<li>打包当前目录，DockerFile 就在当前目录：docker build -t 镜像名 . </li>\n<li>创建实例并运行,-d 是后台运行，-p 是指定映射端口号：docker run -d -p 2999:2999 镜像 ID</li>\n<li>查看日志：docker logs + 镜像 ID<ul>\n<li>–details 显示提供给日志的其他详细信息</li>\n<li>–follow , -f 实时跟踪日志输出</li>\n<li>–since 显示自某个 timestamp 之后的日志大于等于某个时间，或相对时间，如 1h 就是 1h）</li>\n<li>–tail , -n all 从日志末尾显示的行数，默认值为 all 全部</li>\n<li>–timestamps , -t 日志每行显示日志时间戳</li>\n<li>–until 显示自某个 timestamp 之前的日志小于等于某个时间，或相对时间，如 30m（即 30 分钟）</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"替换 Jar 包\"><a href=\"# 替换 Jar 包\" class=\"headerlink\" title=\"替换 Jar 包\"></a>替换 Jar 包</h3><ul>\n<li>docker stop containerID #停止容器实例</li>\n<li>docker ps -a containerID # 查看 docker 中的所有容器实例，包括已经停止运行了的</li>\n<li>docker cp web-erp-1.0-SNAPSHOT.jar containerID:/opt/app/web-erp-1.0-SNAPSHOT.jar #将宿主机的文件复制到容器中</li>\n<li>docker start containerID #运行容器实例</li>\n</ul>\n<h3 id=\"nohup 部署，可远程 JVM 来 DEBUG\"><a href=\"#nohup 部署，可远程 JVM 来 DEBUG\" class=\"headerlink\" title=\"nohup 部署，可远程 JVM 来 DEBUG\"></a>nohup 部署，可远程 JVM 来 DEBUG</h3><ul>\n<li>nohup java -Xdebug -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005 -jar web-erp-1.0-SNAPSHOT.jar &amp;</li>\n</ul>\n<h2 id=\"部署 xxl-job\"><a href=\"# 部署 xxl-job\" class=\"headerlink\" title=\"部署 xxl-job\"></a>部署 xxl-job</h2><blockquote>\n<ul>\n<li>拉取：docker pull xuxueli/xxl-job-admin:2.3.1</li>\n<li>运行(mysql 也是使用 docker 部署的，且容器 name 为 mysql)：docker run -d -e PARAMS=”–spring.datasource.url=jdbc:mysql://mysql:3306/xxl_job?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true –spring.datasource.username=root –spring.datasource.password=060119 –spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver” -p 8282:8080 -v /tmp:/data/applogs –name xxl-job-admin  -d –link mysql:mysql  xuxueli/xxl-job-admin:2.3.1</li>\n<li>运行(mysql 可以不使用 docker 部署)</li>\n</ul>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">-e PARAMS=<span class=\"string\">&quot;--spring.datasource.url=jdbc:mysql://jcqing.cc:13306/xxl_job?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true \\</span></span><br><span class=\"line\"><span class=\"string\">--spring.datasource.username=xtzl \\</span></span><br><span class=\"line\"><span class=\"string\">--spring.datasource.password=xtzlabc \\</span></span><br><span class=\"line\"><span class=\"string\">--spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver&quot;</span> \\</span><br><span class=\"line\">-p 8282:8080 \\</span><br><span class=\"line\">-v /tmp:/data/applogs \\</span><br><span class=\"line\">--name xxl-job-admin \\</span><br><span class=\"line\">-d \\</span><br><span class=\"line\">xuxueli/xxl-job-admin:2.3.1</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"命令图\"><a href=\"# 命令图\" class=\"headerlink\" title=\"命令图\"></a>命令图</h1><img src= \"http://xtzl.wentexl.cn/docker.png\"/>\n\n<h1 id=\"docker 数据卷\"><a href=\"#docker 数据卷\" class=\"headerlink\" title=\"docker 数据卷\"></a>docker 数据卷 </h1><h2 id=\"相关命令\"><a href=\"# 相关命令\" class=\"headerlink\" title=\"相关命令\"></a> 相关命令</h2><ul>\n<li>创建数据卷：docker volume create    </li>\n<li>查看所有数据卷：docker volume ls    </li>\n<li>删除指定数据卷：docker volume rm    </li>\n<li>查看某个数据卷的详情：docker volume inspect    </li>\n<li>清除数据卷：docker volume prune    </li>\n</ul>\n<h1 id=\"添加 docker 的镜像\"><a href=\"# 添加 docker 的镜像\" class=\"headerlink\" title=\"添加 docker 的镜像\"></a>添加 docker 的镜像 </h1><h2 id=\"修改 daemon-json 文件\"><a href=\"# 修改 daemon-json 文件\" class=\"headerlink\" title=\"修改 daemon.json 文件\"></a> 修改 daemon.json 文件 </h2><h2 id=\"查看 DNS\"><a href=\"# 查看 DNS\" class=\"headerlink\" title=\"查看 DNS\"></a> 查看 DNS</h2><blockquote>\n<p>dig @114.114.114.114 registry-1.docker.io</p>\n</blockquote>\n<h2 id=\"添加 hosts 解析\"><a href=\"# 添加 hosts 解析\" class=\"headerlink\" title=\"添加 hosts 解析\"></a>添加 hosts 解析</h2><blockquote>\n<p>vim /etc/hosts</p>\n</blockquote>\n<p>34.226.69.105</p>\n","url":"/posts/54426/","min2read":3,"word4post":733,"prev_post":{"title":"Requirements-Recruitment-System","url":"/posts/38530/"},"next_post":{"title":"boot-Cache","url":"/posts/21114/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"容器基本命令\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">容器基本命令</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"实例命令\" href = \"#\"><span class=\"toc-number\">1.1.</span> <span class=\"toc-text\">实例命令</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"镜像命令\" href = \"#\"><span class=\"toc-number\">1.2.</span> <span class=\"toc-text\">镜像命令</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"部署 SpringBoot 项目\" href = \"#\"><span class=\"toc-number\">1.3.</span> <span class=\"toc-text\">部署 SpringBoot 项目 </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"首次部署\" href = \"#\"><span class=\"toc-number\">1.3.1.</span> <span class=\"toc-text\"> 首次部署</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"替换 Jar 包\" href = \"#\"><span class=\"toc-number\">1.3.2.</span> <span class=\"toc-text\">替换 Jar 包</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"nohup 部署，可远程 JVM 来 DEBUG\" href = \"#\"><span class=\"toc-number\">1.3.3.</span> <span class=\"toc-text\">nohup 部署，可远程 JVM 来 DEBUG</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"部署 xxl-job\" href = \"#\"><span class=\"toc-number\">1.4.</span> <span class=\"toc-text\">部署 xxl-job</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"命令图\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\">命令图</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"docker 数据卷\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\">docker 数据卷 </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"相关命令\" href = \"#\"><span class=\"toc-number\">3.1.</span> <span class=\"toc-text\"> 相关命令</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"添加 docker 的镜像\" href = \"#\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\">添加 docker 的镜像 </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"修改 daemon-json 文件\" href = \"#\"><span class=\"toc-number\">4.1.</span> <span class=\"toc-text\"> 修改 daemon.json 文件 </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"查看 DNS\" href = \"#\"><span class=\"toc-number\">4.2.</span> <span class=\"toc-text\"> 查看 DNS</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"添加 hosts 解析\" href = \"#\"><span class=\"toc-number\">4.3.</span> <span class=\"toc-text\">添加 hosts 解析</span></a></li></ol></li></ol>","categories":[{"name":"Accumulate","path":"api/categories/Accumulate.json","url":"/categories/Accumulate/"}],"tags":[]}