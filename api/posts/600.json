{"title":"boot-globalExceptionHandler","slug":"boot-globalExceptionHandler","date":"2023-03-31","updated":"2023-04-02","comments":true,"path":"api/posts/600.json","excerpt":"<blockquote><p> 全局异常处理器 </p></blockquote>","cover":null,"covers":null,"content":"<blockquote>\n<p> 全局异常处理器 </p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"枚举类\"><a href=\"# 枚举类\" class=\"headerlink\" title=\"枚举类\"></a> 枚举类 </h1><blockquote>\n<p> 通过使用枚举类完成对返回错误的统一定义，结合全局异常管理器实现全局的异常处理 </p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">ErrorCode</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/* 成功 */</span></span><br><span class=\"line\">    SUCCESS(<span class=\"number\">200</span>, <span class=\"string\">&quot; 成功 &quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* 默认失败 */</span></span><br><span class=\"line\">    COMMON_FAIL(<span class=\"number\">999</span>, <span class=\"string\">&quot; 失败 &quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* 参数错误：1000～1999 */</span></span><br><span class=\"line\">    PARAM_NOT_VALID(<span class=\"number\">1001</span>, <span class=\"string\">&quot; 参数无效 &quot;</span>),</span><br><span class=\"line\">    PARAM_IS_BLANK(<span class=\"number\">1002</span>, <span class=\"string\">&quot; 参数为空 &quot;</span>),</span><br><span class=\"line\">    PARAM_TYPE_ERROR(<span class=\"number\">1003</span>, <span class=\"string\">&quot; 参数类型错误 &quot;</span>),</span><br><span class=\"line\">    PARAM_NOT_COMPLETE(<span class=\"number\">1004</span>, <span class=\"string\">&quot; 参数缺失 &quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* 用户错误 */</span></span><br><span class=\"line\">    USER_NOT_LOGIN(<span class=\"number\">2001</span>, <span class=\"string\">&quot; 用户未登录 &quot;</span>),</span><br><span class=\"line\">    USER_ACCOUNT_EXPIRED(<span class=\"number\">2002</span>, <span class=\"string\">&quot; 账号已过期 &quot;</span>),</span><br><span class=\"line\">    USER_CREDENTIALS_ERROR(<span class=\"number\">2003</span>, <span class=\"string\">&quot; 密码错误 &quot;</span>),</span><br><span class=\"line\">    USER_CREDENTIALS_EXPIRED(<span class=\"number\">2004</span>, <span class=\"string\">&quot; 密码过期 &quot;</span>),</span><br><span class=\"line\">    USER_ACCOUNT_DISABLE(<span class=\"number\">2005</span>, <span class=\"string\">&quot; 账号不可用 &quot;</span>),</span><br><span class=\"line\">    USER_ACCOUNT_LOCKED(<span class=\"number\">2006</span>, <span class=\"string\">&quot; 账号被锁定 &quot;</span>),</span><br><span class=\"line\">    USER_ACCOUNT_NOT_EXIST(<span class=\"number\">2007</span>, <span class=\"string\">&quot; 账号不存在 &quot;</span>),</span><br><span class=\"line\">    USER_ACCOUNT_ALREADY_EXIST(<span class=\"number\">2008</span>, <span class=\"string\">&quot; 账号已存在 &quot;</span>),</span><br><span class=\"line\">    USER_ACCOUNT_USE_BY_OTHERS(<span class=\"number\">2009</span>, <span class=\"string\">&quot; 账号下线 &quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* 业务错误 */</span></span><br><span class=\"line\">    NO_PERMISSION(<span class=\"number\">3001</span>, <span class=\"string\">&quot; 没有权限 &quot;</span>),</span><br><span class=\"line\">    Anonymous_Access(<span class=\"number\">3002</span>,<span class=\"string\">&quot; 匿名用户访问异常 &quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer code;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String message;</span><br><span class=\"line\"></span><br><span class=\"line\">    ErrorCode(Integer code, String message) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.code = code;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.message = message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Integer <span class=\"title function_\">getCode</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> code;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setCode</span><span class=\"params\">(Integer code)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.code = code;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getMessage</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setMessage</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.message = message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"自定义异常\"><a href=\"# 自定义异常\" class=\"headerlink\" title=\"自定义异常\"></a> 自定义异常 </h1><blockquote>\n<p> 如果 Java.net 包下的异常够用也不用自定义异常，自定义异常主要是用于扩展使用 </p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AnonymousAccessException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">RuntimeException</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"type\">Integer</span> <span class=\"variable\">code</span> <span class=\"operator\">=</span> ErrorCode.Anonymous_Access.getCode();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> ErrorCode.Anonymous_Access.getMessage();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Integer <span class=\"title function_\">getCode</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> code;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getMessage</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"使用全局异常管理器\"><a href=\"# 使用全局异常管理器\" class=\"headerlink\" title=\"使用全局异常管理器\"></a> 使用全局异常管理器 </h1><blockquote>\n<p> 在这里可以对捕获的所有的异常进行一个统一的管理和处理 </p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ControllerAdvice</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GlobalExceptionHandler</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** 参数校验异常 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ExceptionHandler(BindException.class)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Result <span class=\"title function_\">bindException</span><span class=\"params\">(BindException e)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>  ResultTool.failWithMessage(e.getMessage());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/** 自定义匿名异常 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ExceptionHandler(AnonymousAccessException.class)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Result <span class=\"title function_\">anonymousException</span><span class=\"params\">(AnonymousAccessException e)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResultTool.failWithCodeAndMessage(e.getCode(),e.getMessage());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;   </span><br></pre></td></tr></table></figure>","url":"/posts/600/","min2read":2,"word4post":429,"prev_post":null,"next_post":{"title":"BigData-Spark","url":"/posts/51645/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"枚举类\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\"> 枚举类 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"自定义异常\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\"> 自定义异常 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"使用全局异常管理器\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\"> 使用全局异常管理器 </span></a></li></ol>","categories":[{"name":"SpringBoot","path":"api/categories/SpringBoot.json","url":"/categories/SpringBoot/"}],"tags":[]}